var p=Object.getPrototypeOf,T,H,S,_,z={isConnected:1},xe=1e3,I,Q={},Ae=p(z),j=p(p),g,ee=(e,l,n,t)=>(e??(setTimeout(n,t),new Set)).add(l),te=(e,l,n)=>{let t=S;S=l;try{return e(n)}catch(r){return console.error(r),n}finally{S=t}},V=e=>e.filter(l=>l._dom?.isConnected),le=e=>I=ee(I,e,()=>{for(let l of I)l._bindings=V(l._bindings),l._listeners=V(l._listeners);I=g},xe),C={get val(){return S?._getters?.add(this),this.rawVal},get oldVal(){return S?._getters?.add(this),this._oldVal},set val(e){S?._setters?.add(this),e!==this.rawVal&&(this.rawVal=e,this._bindings.length+this._listeners.length?(H?.add(this),T=ee(T,this,Ve)):this._oldVal=e)}},ne=e=>({__proto__:C,rawVal:e,_oldVal:e,_bindings:[],_listeners:[]}),k=(e,l)=>{let n={_getters:new Set,_setters:new Set},t={f:e},r=_;_=[];let o=te(e,n,l);o=(o??document).nodeType?o:new Text(o);for(let a of n._getters)n._setters.has(a)||(le(a),a._bindings.push(t));for(let a of _)a._dom=o;return _=r,t._dom=o},G=(e,l=ne(),n)=>{let t={_getters:new Set,_setters:new Set},r={f:e,s:l};r._dom=n??_?.push(r)??z,l.val=te(e,t,l.rawVal);for(let o of t._getters)t._setters.has(o)||(le(o),o._listeners.push(r));return l},re=(e,...l)=>{for(let n of l.flat(1/0)){let t=p(n??0),r=t===C?k(()=>n.val):t===j?k(n):n;r!=g&&e.append(r)}return e},oe=(e,l,...n)=>{let[t,...r]=p(n[0]??0)===Ae?n:[{},...n],o=e?document.createElementNS(e,l):document.createElement(l);for(let[a,i]of Object.entries(t)){let s=b=>b?Object.getOwnPropertyDescriptor(b,a)??s(p(b)):g,u=l+","+a,d=Q[u]??(Q[u]=s(p(o))?.set??0),A=a.startsWith("on")?(b,De)=>{let $=a.slice(2);o.removeEventListener($,De),o.addEventListener($,b)}:d?d.bind(o):o.setAttribute.bind(o,a),N=p(i??0);a.startsWith("on")||N===j&&(i=G(i),N=C),N===C?k(()=>(A(i.val,i._oldVal),o)):A(i)}return re(o,...r)},Y=e=>({get:(l,n)=>oe.bind(g,e,n)}),Ie=new Proxy(e=>new Proxy(oe,Y(e)),Y()),ae=(e,l)=>l?l!==e&&e.replaceWith(l):e.remove(),Ve=()=>{let e=0,l=[...T].filter(t=>t.rawVal!==t._oldVal);do{H=new Set;for(let t of new Set(l.flatMap(r=>r._listeners=V(r._listeners))))G(t.f,t.s,t._dom),t._dom=g}while(++e<100&&(l=[...H]).length);let n=[...T].filter(t=>t.rawVal!==t._oldVal);T=g;for(let t of new Set(n.flatMap(r=>r._bindings=V(r._bindings))))ae(t._dom,k(t.f,t._dom)),t._dom=g;for(let t of n)t._oldVal=t.rawVal},Ce=(e,l)=>ae(e,k(l,e)),c={add:re,tags:Ie,state:ne,derive:G,hydrate:Ce};var{fromEntries:Oe,entries:ue,keys:Pe,getPrototypeOf:ce}=Object,{get:Me,set:ie,deleteProperty:se,ownKeys:Ee}=Reflect,{state:W,derive:Le,add:Be,tags:rt}=c,Ke=ce(W()),O,Ne=1e3,fe,h=Symbol(),He=Symbol(),Ge=Symbol(),P=Symbol(),y=Symbol(),X=Symbol();var de=e=>e?.[Ge]?Le(()=>D(e())):W(D(e)),D=e=>{if(!(e instanceof Object)||e[h])return e;let l=new Proxy((e[h]=Oe(ue(e).map(([n,t])=>[n,de(t)])),e[He]=e,e[P]=[],e[y]=W(1),e),{get:(n,t)=>ce(n[h][t]??0)===Ke?n[h][t].val:(t==="length"&&n[y].val,Me(n,t,l)),set(n,t,r){let o=n[h];if(t in o)return o[t].val=D(r),1;let a=t in n,i=a&&t==="length"&&r!==n.length;if(ie(n,t,r))return a?i&&++n[y].val:ie(o,t,de(r))&&(++n[y].val,Xe(l,t,o[t])),1},deleteProperty:(n,t)=>(se(n[h],t)&&Re(n,t),se(n,t)&&++n[y].val),ownKeys:n=>(n[y].val,Ee(n))});return l};var R=e=>e[P]=e[P].filter(l=>l._containerDom.isConnected),We=(e,l,n,t)=>()=>{let r=t(n,()=>delete e[l],l);return r[X]=l,r},me=(e,l,n,{_containerDom:t,f:r},o)=>{if(Be(t,We(e,l,n,r)),!o&&Array.isArray(e)&&l!=e.length-1){let a={};for(let s of t.childNodes)a[s[X]]=s;let i=t.firstChild;for(let s of Pe(e))i===a[s]?i=i.nextSibling:t.insertBefore(a[s],i)}},Xe=(e,l,n)=>R(e).forEach(me.bind(fe,e,l,n)),Re=(e,l)=>{for(let n of R(e))[...n._containerDom.childNodes].find(t=>t[X]===l)?.remove()},Fe=e=>(O??(O=(setTimeout(()=>(O.forEach(R),O=fe),Ne),new Set))).add(e),pe=(e,l,n)=>{let t={_containerDom:e(),f:n};l[P].push(t),Fe(l);for(let[r,o]of ue(l[h]))me(l,r,o,t,1);return t._containerDom};var{div:f,input:q,button:m,span:M,br:E,label:B,select:ye,option:Z,dialog:ve,h2:we,h3:Ze,form:be,iframe:qe,"x-dialog":_e}=c.tags,ge="timers",L="random",w=[["random","Random"],["air-raid","Air Raid","QaAK2JPE5p4?si=YXV04T1up7wfZxZZ"],["bell","Bell","475-VWbH3wY?si=lROSHQltHmUmtqpZ&start=2"],["fire-truck","Fire Truck","5rpMLGS-eBs?si=P0A12rm0JRMw0gBP"],["kyrie","Kyrie eleison","djkLm3WpUOE?si=De1srN8wGi3BTvlI"],["song","Song","mIxkMXqH8hI?si=4LxW-dKjtD7JACoX"],["tibetan","Tibetan","aXH-QsPTeEI?si=-TjIBSVmy8UWbprt"],["warfare","Warfare","Zjc8Ptc1o6U?si=bvqK34G4kopK8q1B"]];function Ue(){let e=!0,l=JSON.parse(localStorage.getItem(ge)??'{"sound":"random","timers":[]}'),n=D({sound:l.sound||"random",allowedSounds:l.allowedSounds??[],timers:l.timers.filter(r=>r)});L=n.sound;let t=n.timers;return c.derive(()=>{if(e)return e=!1,{sound:n.sound,showSoundOptions:n.allowedSounds.filter(o=>o),timers:t.map(o=>({...o}))};let r=JSON.stringify(n);localStorage.setItem(ge,r)}),[pe(f,t,({val:r})=>{let{hours:o,minutes:a,seconds:i}=r,s=c.state(0),u=c.state("stopped");return f(f(B(q({class:"plain",type:"text",value:r.title||null,placeholder:"Title",onchange:d=>r.title=d.target.value}),M({class:"editable-pencil",innerHTML:"&#9998;"}))),f(F(o,"Hrs",d=>r.hours=+(d.target?.value||0)),":",F(a,"Min",d=>r.minutes=+(d.target?.value||0)),":",F(i,"Sec",d=>r.seconds=+(d.target?.value||0))," \u2014 ",$e(r,n.allowedSounds,s,u),m({class:()=>u.val==="stopped"?"":"hidden",onclick:()=>{u.val="running",Se(r,s,u)}},"Start"),m({onclick:()=>{u.val="running",Se(r,s,u)},innerHTML:"&#8635;",class:()=>u.val==="alarm"?"":"hidden"}),m({innerHTML:"&#9881;",onclick:Ye(r)}),m({onclick:()=>{let d=t.findIndex(A=>A.id===r.id);d>=0&&t.splice(d,1)}},"\u274C")))}),E(),f(m({onclick:()=>t.push({id:je(t),hours:0,minutes:0,seconds:0,title:"",sound:null})},"Add Timer")),E(),f(B("Sound"),E(),ye({onchange:r=>L=n.sound=r.target.value},w.map(([r,o])=>Z({value:r,selected:r===L},o))),m({innerHTML:"&#9881;",onclick:Qe(n)}))]}function F(e,l,n){return q({class:"clock-input",type:"number",value:e||"",placeholder:l,onchange:n})}function $e(e,l,n,t){let r=m({class:()=>t.val==="alarm"?"naked overlay":"naked",title:"Click to stop.","aria-label":"Click to stop.",onclick:()=>{t.val="stopped",U(e.id)}},()=>{if(t.val==="running"){let o=n.val,a=J(Math.floor(o/3600)),i=J(Math.floor(o/60)%60),s=J(o%60);return`${a}:${i}:${s}`}return""});return M({class:"relative-container"},r,M(()=>t.val==="alarm"?M(Te(e.sound??L,l)):""))}var K=document.getElementById("dialogs");function Qe(e){return()=>{K&&(e.allowedSounds.length===0&&e.allowedSounds.push(...w.slice(1).map(([l])=>l)),c.add(K,_e(ve({class:"modal"},f(we({class:"inline"},"Options"),be({class:"inline",method:"dialog"},m({value:"cancel"},"Close"))),Ze("Allowed Sounds"),w.slice(1).map(([l,n])=>f({onchange:t=>{if(t.target.checked)e.allowedSounds.push(l);else{let r=e.allowedSounds.indexOf(l);r>=0&&e.allowedSounds.splice(r,1)}}},B(q({type:"checkbox",value:l,checked:e.allowedSounds.includes(l)}),n)))))))}}function Ye(e){return()=>{K&&c.add(K,_e(ve({class:"modal"},f(we({class:"inline"},"Options"),be({class:"inline",method:"dialog"},m({value:"cancel"},"Close"))),B("Sound",E(),ye({onchange:l=>{e.sound=l.target.value}},Z({value:"default",selected:e.sound==null},"Default"),w.map(([l,n])=>Z({value:l,selected:l===e.sound},n)))))))}}var ze=w.slice(1).map(([e])=>e);function Te(e,l){if(e==="random"){let t=ze.filter(r=>l.length===0||l.includes(r));return Te(t[Math.floor(Math.random()*t.length)],l)}let n=w.find(([t])=>t===e);if(n)return qe({width:"112",height:"63",style:"position:relative;top:23px;",src:`https://www.youtube.com/embed/${n[2]}&autoplay=1`,title:"Time up",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"})}function je(e){return Math.max(...e.map(n=>n.id),0)+1}var he=document.getElementById("timer");he?c.add(he,Ue()):console.error("No timer element found");var v={},x=null;function et(e,l,n){let t=ke(e),r=Date.now()/1e3;v[e.id]={fn:l,startedAt:r,totalSeconds:t,id:e.id,timeoutId:setTimeout(()=>{U(e.id),n(e.id)},t*1e3)},tt()}function tt(){x||(x=setInterval(()=>{let e=Date.now()/1e3;for(let l of Object.values(v)){let n=e-l.startedAt,t=Math.round(l.totalSeconds-n);l.fn(t)}},1e3))}function U(e){v[e]&&(clearTimeout(v[e].timeoutId),delete v[e],Object.keys(v).length===0&&x&&(clearInterval(x),x=null))}function Se(e,l,n){l.val=ke(e),et(e,t=>l.val=t,t=>{n.val="alarm",U(t)})}function ke(e){let{hours:l,minutes:n,seconds:t}=e;return l*3600+n*60+t}function J(e){return e.toString().padStart(2,"0")}
