(()=>{var P=Object,c,d=P.getPrototypeOf,E=document,w,g,v,$={isConnected:1},ve=1e3,T,W={},ge=d($),J=d(d),q=(e,t,l,n)=>(e??(setTimeout(l,n),new Set)).add(t),Q=(e,t,l)=>{let n=g;g=t;try{return e(l)}catch(a){return console.error(a),l}finally{g=n}},D=e=>e.filter(t=>t._dom?.isConnected),U=e=>T=q(T,e,()=>{for(let t of T)t._bindings=D(t._bindings),t._listeners=D(t._listeners);T=c},ve),h={get val(){return g?.add(this),this._val},get oldVal(){return g?.add(this),this._oldVal},set val(e){let t=this;if(e!==t._val){t._val=e;let l=[...t._listeners=D(t._listeners)];for(let n of l)N(n.f,n.s,n._dom),n._dom=c;t._bindings.length?w=q(w,t,_e):t._oldVal=e}}},Y=e=>({__proto__:h,_val:e,_oldVal:e,_bindings:[],_listeners:[]}),Z=e=>d(e??0)===h,he=e=>Z(e)?e.val:e,Se=e=>Z(e)?e.oldVal:e,S=(e,t)=>{let l=new Set,n={f:e},a=v;v=[];let r=Q(e,l,t);r=(r??E).nodeType?r:new Text(r);for(let o of l)U(o),o._bindings.push(n);for(let o of v)o._dom=r;return v=a,n._dom=r},N=(e,t=Y(),l)=>{let n=new Set,a={f:e,s:t};a._dom=l??v?.push(a)??$,t.val=Q(e,n,t._val);for(let r of n)U(r),r._listeners.push(a);return t},j=(e,...t)=>{for(let l of t.flat(1/0)){let n=d(l??0),a=n===h?S(()=>l.val):n===J?S(l):l;a!=c&&e.append(a)}return e},ye=e=>(e._isBindingFunc=1,e),X=e=>new Proxy((t,...l)=>{let[n,...a]=d(l[0]??0)===ge?l:[{},...l],r=e?E.createElementNS(e,t):E.createElement(t);for(let[o,i]of P.entries(n)){let s=m=>m?P.getOwnPropertyDescriptor(m,o)??s(d(m)):c,G=t+","+o,z=W[G]??(W[G]=s(d(r))?.set??0),H=o.startsWith("on")?(m,me)=>{let R=o.slice(2);r.removeEventListener(R,me),r.addEventListener(R,m)}:z?z.bind(r):r.setAttribute.bind(r,o),x=d(i??0);x===J&&(!o.startsWith("on")||i._isBindingFunc)&&(i=N(i),x=h),x===h?S(()=>(H(i.val,i._oldVal),r)):H(i)}return j(r,...a)},{get:(t,l)=>t.bind(c,l)}),ee=(e,t)=>t?t!==e&&e.replaceWith(t):e.remove(),_e=()=>{let e=[...w].filter(t=>t._val!==t._oldVal);w=c;for(let t of new Set(e.flatMap(l=>l._bindings=D(l._bindings))))ee(t._dom,S(t.f,t._dom)),t._dom=c;for(let t of e)t._oldVal=t._val},be=(e,t)=>ee(e,S(t,e)),u={add:j,_:ye,tags:X(),tagsNS:X,state:Y,val:he,oldVal:Se,derive:N,hydrate:be};var{fromEntries:Te,entries:re,keys:we,getPrototypeOf:oe}=Object,{get:De,set:te,deleteProperty:le,ownKeys:ke}=Reflect,p=Symbol,{state:M,derive:Ae,add:Ce,tags:We}=u,Ie=oe(M()),k,xe=1e3,ae,f=p(),Pe=p(),Ee=p(),A=p(),y=p(),V=p();var ne=e=>e?.[Ee]?Ae(()=>_(e())):M(_(e)),_=e=>{if(!(e instanceof Object)||e[f])return e;let t=new Proxy((e[f]=Te(re(e).map(([l,n])=>[l,ne(n)])),e[Pe]=e,e[A]=[],e[y]=M(1),e),{get:(l,n)=>oe(l[f][n]??0)===Ie?l[f][n].val:(n==="length"&&l[y].val,De(l,n,t)),set(l,n,a){let r=l[f];if(n in r)return r[n].val=_(a),1;let o=n in l;if(te(l,n,a))return o||te(r,n,ne(a))&&(++l[y].val,Me(t,n,r[n])),1},deleteProperty:(l,n)=>(le(l[f],n)&&Ve(l,n),le(l,n)&&++l[y].val),ownKeys:l=>(l[y].val,ke(l))});return t};var B=e=>e[A]=e[A].filter(t=>t._containerDom.isConnected),Ne=(e,t,l,n)=>()=>{let a=n(l,()=>delete e[t],t);return a[V]=t,a},ie=(e,t,l,{_containerDom:n,f:a},r)=>{if(Ce(n,Ne(e,t,l,a)),!r&&Array.isArray(e)&&t!=e.length-1){let o={};for(let s of n.childNodes)o[s[V]]=s;let i=n.firstChild;for(let s of we(e))i===o[s]?i=i.nextSibling:n.insertBefore(o[s],i)}},Me=(e,t,l)=>B(e).forEach(ie.bind(ae,e,t,l)),Ve=(e,t)=>{for(let l of B(e))[...l._containerDom.childNodes].find(n=>n[V]===t)?.remove()},Be=e=>(k??(k=(setTimeout(()=>(k.forEach(B),k=ae),xe),new Set))).add(e),se=(e,t,l)=>{let n={_containerDom:e(),f:l};t[A].push(n),Be(t);for(let[a,r]of re(t[f]))ie(t,a,r,n,1);return n._containerDom};var{div:L,input:O,button:C,span:fe,html:Je}=u.tags,de="appState";function Oe(){let e=_(JSON.parse(localStorage.getItem(de)??"[]").filter(t=>t));return u.derive(()=>{let t=JSON.stringify(e.filter(l=>l));console.log("saving",t),localStorage.setItem(de,t)}),[se(L,e,({val:t})=>{let{hours:l,minutes:n,seconds:a}=t,r=u.state(0),o=u.state("stopped");return L(O({type:"number",value:l||"",placeholder:"Hrs",size:3,onchange:i=>t.hours=+(i.target?.value||0)}),":",O({type:"number",value:n||"",placeholder:"Min",size:3,onchange:i=>t.minutes=+(i.target?.value||0)}),":",O({type:"number",value:a||"",placeholder:"Sec",size:3,onchange:i=>t.seconds=+(i.target?.value||0)})," \u2014 ",fe(ze(r,o)),C({onclick:()=>{switch(o.val){case"running":o.val="stopped",K(t.id);break;case"stopped":o.val="running",ce(t,r,o);break;case"alarm":o.val="stopped";break}}},()=>o.val==="stopped"?"Start":"Stop"),C({onclick:()=>{o.val="running",ce(t,r,o)},innerHTML:"&#8635;",class:()=>o.val==="alarm"?"":"hidden"}),C({onclick:()=>{let i=e.findIndex(s=>s.id===t.id);i>=0&&e.splice(i,1)}},"\u274C"))}),L(C({onclick:()=>e.push({id:Fe(e),hours:0,minutes:0,seconds:0,notes:""})},"Add Timer"))]}function Fe(e){return Math.max(...e.map(l=>l.id),0)+1}var ue=document.getElementById("timer");ue?u.add(ue,Oe()):console.error("No timer element found");var I={},b=null;function Ke(e,t,l){let n=pe(e),a=Date.now()/1e3;I[e.id]={fn:t,startedAt:a,totalSeconds:n,id:e.id},setTimeout(()=>{K(e.id),l(e.id)},n*1e3),Ge()}function Ge(){b||(b=setInterval(()=>{let e=Date.now()/1e3;for(let t of Object.values(I)){let l=e-t.startedAt,n=t.totalSeconds-l;t.fn(n)}},1e3))}function K(e){delete I[e],Object.keys(I).length===0&&b&&(clearInterval(b),b=null)}function ce(e,t,l){t.val=pe(e),Ke(e,n=>t.val=n,n=>{l.val="alarm",K(n)})}function ze(e,t){return()=>{let l=e.val|0;switch(t.val){case"alarm":let n=document.getElementById("bell");if(!(n instanceof HTMLTemplateElement))return"ALARM";let a=n.content.cloneNode(!0);return fe(a);case"stopped":return"";case"running":let r=F(Math.floor(l/3600)),o=F(Math.floor(l/60)%60),i=F(l%60);return`${r}:${o}:${i}`}}}function pe(e){let{hours:t,minutes:l,seconds:n}=e;return t*3600+l*60+n}function F(e){return e.toString().padStart(2,"0")}})();
